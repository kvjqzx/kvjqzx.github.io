##Bootloader是什么?
系统上电后，需要一段程序来进行初始化，如果它能将操作系统内核复制到内存中运行，无论从本地还是从远端，就称这段程序为Bootloader。

Bootloader就是这么一段程序，它在系统上电时开始执行，初始化硬件设备、准备好软件环境，最后调用操作系统内核。

CPU上电后，会从某个地址开始执行，比如MIPS架构的CPU会从0xBFC0000取第一条指令，而ARM结构的CPU则从地址0x000000开始。嵌入式开发板中，需要把存储器件ROM或Flash等映射到这个地址，Bootloader就存放在这个地址开始处，这样一上电就可以执行。


##嵌入式Linux系统从软件的角度可分为4个层次：

* 引导加载程序
包括固化在固件中的boot代码和Bootloader两大部分。
有些CPU在运行Bootloader之前先运行一段固化程序，比如x86结构的CPU就是先运行BIOS中的固件，然后才运行硬盘第一个分区（MBR）中的Bootloader。在大多数嵌入式系统中并没有固件，Bootloader是上电后执行的第一个程序。
* Linux内核
* 文件系统 包括根文件系统和建立于Flash内存设备之上的文件系统。
* 用户应用程序 特定于用户的应用程序，它们也存储在文件系统中。


Bootloader的启动过程可分为单阶段（Single Stage）、多阶段（Multi Stage）两种。

通常多阶段的Bootloader能提供更为复杂的功能以及更好的可移植性。从固态设备上启动的Bootloader大多都是两阶段的启动过程。

第一阶段用汇编实现，完成一些依赖CPU体系结构的初始化，并调用第二阶段的代码。
第二阶段通常用C语言实现，这样可以实现更复杂的功能。

Bootloader第一阶段功能：

    * 硬件设备初始化
	* 为加载Bootloader的第二阶段代码准备RAM空间
	* 复制Bootloader的第二阶段的代码到RAM中
	* 设置好栈
	* 跳转到第二阶段代码的C入口点

Bootloader第二阶段

	* 初始化本阶段要用到的硬件设备
	* 检测系统内存映射
	* 将内核映像和根文件系统映像从Flash上读到RAM空间
	* 为内核设置启动参数
	* 调用内核
